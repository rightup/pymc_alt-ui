(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{13364:(e,t,s)=>{"use strict";function r(e){if(e<60)return`${Math.floor(e)}s`;let t=Math.floor(e/86400),s=Math.floor(e%86400/3600),r=Math.floor(e%3600/60),a=[];return t>0&&a.push(`${t}d`),s>0&&a.push(`${s}h`),(r>0||0===a.length)&&a.push(`${r}m`),a.join(" ")}function a(e){let t=Date.now()/1e3-e;return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`}function n(e){return new Date(1e3*e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}function l(e){return new Date(1e3*e).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}function c(e){return`${(e/1e6).toFixed(3)} MHz`}function i(e){return`${(e/1e3).toFixed(1)} kHz`}s.d(t,{$o:()=>i,QR:()=>c,Y0:()=>r,fU:()=>l,fw:()=>a,r6:()=>n})},16950:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(78340).A)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},27529:(e,t,s)=>{"use strict";s.d(t,{A_:()=>d,Fz:()=>h,GT:()=>n,Nw:()=>i,Ty:()=>p,V0:()=>c,VS:()=>f,ao:()=>l,bx:()=>o,f3:()=>u,iY:()=>x,w7:()=>m});let r=s(41463).env.NEXT_PUBLIC_API_URL||"";async function a(e,t){let s=`${r}${e}`,a={};if(t?.headers){let e=t.headers;e instanceof Headers?e.forEach((e,t)=>{a[t]=e}):Array.isArray(e)?e.forEach(([e,t])=>{a[e]=t}):Object.assign(a,e)}t?.body&&(a["Content-Type"]="application/json");let n=await fetch(s,{...t,headers:a});if(!n.ok)throw Error(`API error: ${n.status} ${n.statusText}`);return n.json()}async function n(){return a("/api/stats")}async function l(){return a("/api/logs")}async function c(e=100){return a(`/api/recent_packets?limit=${e}`)}async function i(e=24){return a(`/api/packet_type_graph_data?hours=${e}`)}async function o(e=24){return a(`/api/noise_floor_chart_data?hours=${e}`)}async function d(){return a("/api/hardware_stats")}async function u(){return a("/api/send_advert",{method:"POST"})}async function x(e){return a("/api/set_mode",{method:"POST",body:JSON.stringify({mode:e})})}async function p(e){return a("/api/set_duty_cycle",{method:"POST",body:JSON.stringify({enabled:e})})}async function h(e=20,t=20){return a(`/api/bucketed_stats?minutes=${e}&buckets=${t}`)}async function m(e=24){return a(`/api/utilization?hours=${e}`)}async function f(e){return a("/api/update_radio_config",{method:"POST",body:JSON.stringify(e)})}},28947:(e,t,s)=>{"use strict";s.d(t,{$K:()=>n,Fl:()=>c,ir:()=>l,wv:()=>a,zz:()=>i});var r=s(62507);function a(e){return null==e?"UNKNOWN":r.x[e]||`TYPE_${e}`}function n(e){return null==e?"UNKNOWN":r.C[e]||`ROUTE_${e}`}function l(e){return({ADVERT:"text-[var(--pkt-advert)]",FLOOD:"text-[var(--pkt-flood)]",TXT_MSG:"text-[var(--pkt-txt-msg)]",ACK:"text-[var(--pkt-ack)]",TRACE:"text-[var(--pkt-trace)]",REQ:"text-[var(--pkt-req)]",RESPONSE:"text-[var(--pkt-response)]",GRP_TXT:"text-[var(--pkt-grp-txt)]",GRP_DATA:"text-[var(--pkt-grp-data)]",PATH:"text-[var(--pkt-path)]",ANON_REQ:"text-[var(--pkt-anon)]"})[e]||"text-[var(--pkt-unknown)]"}function c(e){return({FLOOD:"bg-[var(--route-flood)]/20 text-[var(--route-flood)] border-[var(--route-flood)]/30",DIRECT:"bg-[var(--route-direct)]/20 text-[var(--route-direct)] border-[var(--route-direct)]/30",TRANSPORT:"bg-[var(--route-transport)]/20 text-[var(--route-transport)] border-[var(--route-transport)]/30",T_FLOOD:"bg-[var(--route-flood)]/20 text-[var(--route-flood)] border-[var(--route-flood)]/30",T_DIRECT:"bg-[var(--route-direct)]/20 text-[var(--route-direct)] border-[var(--route-direct)]/30"})[e]||"bg-bg-subtle text-text-muted border-border-subtle"}function i(e){return 1===e||!0===e}},29722:(e,t,s)=>{"use strict";function r(){for(var e,t,s=0,r="",a=arguments.length;s<a;s++)(e=arguments[s])&&(t=function e(t){var s,r,a="";if("string"==typeof t||"number"==typeof t)a+=t;else if("object"==typeof t)if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(r=e(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}(e))&&(r&&(r+=" "),r+=t);return r}s.d(t,{$:()=>r,A:()=>a});let a=r},33210:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(78340).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},46029:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(78340).A)("radio",[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},48884:(e,t,s)=>{"use strict";s.d(t,{CM:()=>r,Eo:()=>d,IA:()=>n,JW:()=>a,v5:()=>i,xt:()=>c});let r=[{label:"20m",minutes:20,buckets:40},{label:"1h",minutes:60,buckets:60},{label:"3h",minutes:180,buckets:90},{label:"12h",minutes:720,buckets:72},{label:"24h",minutes:1440,buckets:96},{label:"3d",minutes:4320,buckets:72},{label:"7d",minutes:10080,buckets:84}],a=[{label:"1h",hours:1},{label:"3h",hours:3},{label:"12h",hours:12},{label:"24h",hours:24},{label:"3d",hours:72},{label:"7d",hours:168}],n={received:"#39D98A",forwarded:"#60A5FA",transmitted:"#F9D26F",dropped:"#FF5C7A",neutral:"#B0B0C3"},l={advert:"ADVERT",grp_txt:"GRP_TXT",txt_msg:"TXT_MSG",response:"RESPONSE",anon_req:"ANON_REQ",path:"PATH",req:"REQ",ack:"ACK"};function c(e){return l[e.toLowerCase()]||e.toUpperCase().slice(0,8)}let i={stats:3e3,packets:3e3,charts:3e4,logs:2e3,system:3e3},o={DEBUG:"text-[var(--log-debug)] border-[var(--log-debug)]/30",INFO:"text-[var(--log-info)] border-[var(--log-info)]/30",WARNING:"text-[var(--log-warning)] border-[var(--log-warning)]/30",ERROR:"text-[var(--log-error)] border-[var(--log-error)]/30",CRITICAL:"text-[var(--log-critical)] border-[var(--log-critical)]/50 bg-[var(--log-critical)]/10"};function d(e){return o[e]||"text-text-muted border-border-subtle"}},56181:(e,t,s)=>{Promise.resolve().then(s.bind(s,87580))},57060:(e,t,s)=>{"use strict";s.d(t,{n:()=>a});var r=s(12115);function a(e,t,s=!0,n=!1){let l=(0,r.useRef)(e);(0,r.useEffect)(()=>{l.current=e},[e]),(0,r.useEffect)(()=>{if(!s)return;n||l.current();let e=setInterval(()=>{l.current()},t);return()=>clearInterval(e)},[t,s,n])}},62507:(e,t,s)=>{"use strict";s.d(t,{C:()=>a,x:()=>r});let r={0:"REQ",1:"RESPONSE",2:"TXT_MSG",3:"ACK",4:"ADVERT",5:"GRP_TXT",6:"GRP_DATA",7:"ANON_REQ",8:"PATH",9:"TRACE",10:"RAW_CUSTOM"},a={0:"UNKNOWN",1:"DIRECT",2:"FLOOD",3:"TRANSPORT",4:"T_FLOOD",5:"T_DIRECT"}},64964:(e,t,s)=>{"use strict";s.d(t,{Q:()=>i});var r=s(95155),a=s(12115),n=s(94514);let l=(0,s(78340).A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var c=s(29722);function i({hash:e,prefixLength:t=8,suffixLength:s=6,full:i=!1,className:o,size:d="md"}){let[u,x]=(0,a.useState)(!1),[p,h]=(0,a.useState)(!1),m=(0,a.useRef)(null),f=(0,a.useCallback)(t=>{t.preventDefault(),t.stopPropagation(),m.current&&clearTimeout(m.current);let s=function(e){if((window.isSecureContext||"https:"===window.location.protocol||"localhost"===window.location.hostname)&&navigator.clipboard&&"function"==typeof navigator.clipboard.writeText)return navigator.clipboard.writeText(e).catch(()=>{}),!0;try{let t=document.createElement("input");t.setAttribute("type","text"),t.setAttribute("value",e),t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.opacity="0",t.style.pointerEvents="none",document.body.appendChild(t),t.focus(),t.select(),t.setSelectionRange(0,e.length);let s=document.execCommand("copy");return document.body.removeChild(t),s}catch(e){return console.error("Copy failed:",e),!1}}(e);x(!0),m.current=setTimeout(()=>x(!1),2e3),s||console.warn("Copy may have failed for:",e.slice(0,16)+"...")},[e]),y=i||e.length<=t+s+3?e:`${e.slice(0,t)}…${e.slice(-s)}`;return(0,r.jsxs)("button",{type:"button",onClick:f,onMouseEnter:()=>h(!0),onMouseLeave:()=>h(!1),className:(0,c.A)("inline-flex items-center font-mono rounded-md transition-all duration-200","bg-bg-subtle/80 hover:bg-bg-elevated border border-border-subtle hover:border-border-strong","cursor-pointer select-none","sm"===d?"text-[10px] px-1.5 py-0.5 gap-1":"text-xs px-2 py-1 gap-1.5",o),title:`Click to copy: ${e}`,"aria-label":`Copy hash ${e}`,children:[(0,r.jsx)("span",{className:(0,c.A)("transition-colors duration-200",u?"text-accent-success":"text-text-secondary"),children:y}),(0,r.jsx)("span",{className:(0,c.A)("flex items-center justify-center transition-all duration-200","sm"===d?"w-3 h-3":"w-3.5 h-3.5"),children:u?(0,r.jsx)(n.A,{className:(0,c.A)("text-accent-success","sm"===d?"w-2.5 h-2.5":"w-3 h-3")}):(0,r.jsx)(l,{className:(0,c.A)("transition-opacity duration-200",p?"opacity-70":"opacity-40","sm"===d?"w-2.5 h-2.5":"w-3 h-3")})})]})}},78340:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var r=s(12115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim();var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:c="",children:i,iconNode:o,...d},u)=>(0,r.createElement)("svg",{ref:u,...l,width:t,height:t,stroke:e,strokeWidth:a?24*Number(s)/Number(t):s,className:n("lucide",c),...!i&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...o.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(i)?i:[i]])),i=(e,t)=>{let s=(0,r.forwardRef)(({className:s,...l},i)=>(0,r.createElement)(c,{ref:i,iconNode:t,className:n(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...l}));return s.displayName=a(e),s}},83278:(e,t,s)=>{"use strict";let r;s.d(t,{p5:()=>v,xe:()=>g,Sg:()=>b,rf:()=>y,XL:()=>f,jg:()=>h,fL:()=>m,Xb:()=>x,T:()=>p,Ni:()=>j,J3:()=>d,B7:()=>u,Pj:()=>o});var a=s(12115);let n=e=>{let t,s=new Set,r=(e,r)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=r?r:"object"!=typeof a||null===a)?a:Object.assign({},t,a),s.forEach(s=>s(t,e))}},a=()=>t,n={setState:r,getState:a,getInitialState:()=>l,subscribe:e=>(s.add(e),()=>s.delete(e))},l=t=e(r,a,n);return n},l=e=>{let t=e?n(e):n,s=e=>(function(e,t=e=>e){let s=a.useSyncExternalStore(e.subscribe,a.useCallback(()=>t(e.getState()),[e,t]),a.useCallback(()=>t(e.getInitialState()),[e,t]));return a.useDebugValue(s),s})(t,e);return Object.assign(s,t),s};var c=s(27529);let i=(r=(e,t)=>({stats:null,statsLoading:!1,statsError:null,packets:[],packetsLoading:!1,packetsError:null,lastPacketTimestamp:0,logs:[],logsLoading:!1,liveMode:!0,flashReceived:0,flashAdvert:0,fetchStats:async()=>{e({statsLoading:!0,statsError:null});try{let t=await c.GT();e({stats:t,statsLoading:!1})}catch(t){e({statsError:t instanceof Error?t.message:"Failed to fetch stats",statsLoading:!1})}},fetchPackets:async(s=50)=>{e({packetsLoading:!0,packetsError:null});try{let r=await c.V0(s);if(r.success&&r.data){let s=r.data,{lastPacketTimestamp:a}=t(),n=s.length>0?Math.max(...s.map(e=>e.timestamp??0)):0;n>a&&a>0&&e({flashReceived:t().flashReceived+1}),e({packets:s,packetsLoading:!1,lastPacketTimestamp:n||a})}else e({packetsError:r.error||"Failed to fetch packets",packetsLoading:!1})}catch(t){e({packetsError:t instanceof Error?t.message:"Failed to fetch packets",packetsLoading:!1})}},fetchLogs:async()=>{e({logsLoading:!0});try{let t=await c.ao();e({logs:t.logs,logsLoading:!1})}catch(t){e({logsLoading:!1})}},setLiveMode:t=>{e({liveMode:t})},setMode:async e=>{try{(await c.iY(e)).success&&await t().fetchStats()}catch(e){console.error("Failed to set mode:",e)}},setDutyCycle:async e=>{try{(await c.Ty(e)).success&&t().fetchStats()}catch(e){console.error("Failed to set duty cycle:",e)}},sendAdvert:async()=>{try{let s=await c.f3();return s.success&&e({flashAdvert:t().flashAdvert+1}),s.success}catch(e){return console.error("Failed to send advert:",e),!1}},triggerFlashReceived:()=>{e({flashReceived:t().flashReceived+1})},triggerFlashAdvert:()=>{e({flashAdvert:t().flashAdvert+1})}}))?l(r):l,o=i,d=()=>i(e=>e.stats),u=()=>i(e=>e.statsError),x=()=>i(e=>e.packets),p=()=>i(e=>e.packetsLoading),h=()=>i(e=>e.logs),m=()=>i(e=>e.logsLoading),f=()=>i(e=>e.liveMode),y=()=>i(e=>e.flashReceived),b=()=>i(e=>e.flashAdvert),g=()=>i(e=>e.fetchPackets),v=()=>i(e=>e.fetchLogs),j=()=>i(e=>e.setLiveMode)},87580:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>N});var r=s(95155),a=s(12115),n=s(46029),l=s(16950),c=s(91958);let i=(0,s(78340).A)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var o=s(33210),d=s(29722),u=s(27529),x=s(62507),p=s(57060),h=s(48884),m=s(28947),f=s(83278),y=s(13364);function b({packet:e}){return(0,m.zz)(e.transmitted)?(0,r.jsx)("span",{className:"text-xs text-accent-success",children:"✓ TX"}):(0,m.zz)(e.is_duplicate)?(0,r.jsx)("span",{className:"text-xs text-text-muted",children:"Duplicate"}):"No transport keys configured"===e.drop_reason?(0,r.jsx)("span",{className:"text-xs text-accent-secondary",children:"Monitor Only"}):e.drop_reason?(0,r.jsx)("span",{className:"text-xs text-accent-danger",children:e.drop_reason}):(0,r.jsx)("span",{className:"text-xs text-text-muted",children:"RX"})}let g=(0,a.memo)(function({packet:e,index:t,onClick:s,isFlashing:a=!1}){let n=e.payload_type_name||(0,m.wv)(e.payload_type??e.type),l=e.route_type_name||(0,m.$K)(e.route_type??e.route),c=e.payload_length??e.length??0,i=e.snr??0;return(0,r.jsxs)("tr",{onClick:()=>s(e),className:(0,d.A)("cursor-pointer transition-colors duration-150","hover:bg-bg-subtle",(0,m.zz)(e.transmitted)&&"bg-accent-success/5",(0,m.zz)(e.is_duplicate)&&"opacity-50",a&&"flash-row"),children:[(0,r.jsx)("td",{className:"py-3 px-4 text-sm font-mono text-text-secondary",children:(0,y.r6)(e.timestamp)}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)("span",{className:(0,d.A)("text-sm font-medium",(0,m.ir)(n)),children:n})}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)("span",{className:(0,d.A)("px-2 py-0.5 rounded text-xs border",(0,m.Fl)(l)),children:l})}),(0,r.jsxs)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:[e.rssi," dBm"]}),(0,r.jsxs)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:[i.toFixed(1)," dB"]}),(0,r.jsxs)("td",{className:"py-3 px-4 text-sm text-text-secondary",children:[c,"B"]}),(0,r.jsx)("td",{className:"py-3 px-4",children:(0,r.jsx)(b,{packet:e})})]})});var v=s(64964);function j({label:e,children:t}){return(0,r.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,r.jsxs)("span",{className:"text-text-muted",children:[e,":"]}),(0,r.jsx)("span",{className:"text-text-primary",children:t})]})}let k=(0,a.memo)(function({packet:e,onClose:t}){let s=e.payload_type_name||(0,m.wv)(e.payload_type??e.type),a=e.route_type_name||(0,m.$K)(e.route_type??e.route),n=e.payload_length??e.length??0,l=e.snr??0,c=e.tx_delay_ms??0,i="Received",d="text-text-primary";return(0,m.zz)(e.transmitted)?(i="Transmitted",d="text-accent-success"):(0,m.zz)(e.is_duplicate)?(i="Duplicate",d="text-text-muted"):"No transport keys configured"===e.drop_reason?(i="Monitor Only",d="text-accent-secondary"):e.drop_reason&&(i=e.drop_reason,d="text-accent-danger"),(0,r.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:t,children:(0,r.jsxs)("div",{className:"glass-card max-w-lg w-full p-6",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-text-primary",children:"Packet Details"}),(0,r.jsx)("button",{onClick:t,className:"text-text-muted hover:text-text-primary",children:(0,r.jsx)(o.A,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,r.jsx)(j,{label:"Hash",children:(0,r.jsx)(v.Q,{hash:e.packet_hash,size:"sm"})}),(0,r.jsx)(j,{label:"Timestamp",children:(0,y.r6)(e.timestamp)}),(0,r.jsx)(j,{label:"Type",children:(0,r.jsx)("span",{className:(0,m.ir)(s),children:s})}),(0,r.jsx)(j,{label:"Route",children:a}),(0,r.jsxs)(j,{label:"RSSI",children:[e.rssi," dBm"]}),(0,r.jsxs)(j,{label:"SNR",children:[l.toFixed(2)," dB"]}),e.src_hash&&(0,r.jsx)(j,{label:"Source",children:(0,r.jsx)(v.Q,{hash:e.src_hash,size:"sm"})}),e.dst_hash&&(0,r.jsx)(j,{label:"Destination",children:(0,r.jsx)(v.Q,{hash:e.dst_hash,size:"sm"})}),e.path_hash&&(0,r.jsx)(j,{label:"Path",children:(0,r.jsx)(v.Q,{hash:e.path_hash,size:"sm"})}),(0,r.jsxs)(j,{label:"Payload Length",children:[n," bytes"]}),void 0!==e.score&&(0,r.jsx)(j,{label:"Score",children:e.score.toFixed(3)}),(0,r.jsxs)(j,{label:"TX Delay",children:[c.toFixed(1)," ms"]}),(0,r.jsx)(j,{label:"Status",children:(0,r.jsx)("span",{className:d,children:i})})]})]})})});function N(){let[e,t]=(0,a.useState)([]),[s,y]=(0,a.useState)(!0),[b,v]=(0,a.useState)(!0),[j,N]=(0,a.useState)(null),[_,w]=(0,a.useState)({limit:100}),A=(0,f.Sg)(),[T,S]=(0,a.useState)(null),C=(0,a.useRef)(0),R=(0,a.useCallback)(async()=>{try{let e=await (0,u.V0)(_.limit||100);if(e.success&&e.data){let s=e.data;if(void 0!==_.type){let e=x.x[_.type];s=s.filter(t=>{let s=t.type??t.payload_type,r=t.payload_type_name;return s===_.type||r===e})}if(void 0!==_.route){let e=x.C[_.route];s=s.filter(t=>{let s=t.route??t.route_type,r=t.route_type_name;return s===_.route||r===e})}t(s)}}catch{}finally{y(!1)}},[_]);(0,a.useEffect)(()=>{R()},[R]),(0,p.n)(R,h.v5.packets,b,!0),(0,a.useEffect)(()=>{if(A>0&&A!==C.current&&e.length>0){C.current=A;let t=e.find(e=>(e.payload_type_name||(0,m.wv)(e.payload_type??e.type)).toLowerCase().includes("advert"));if(t){let e=String(t.id??t.packet_hash??""),s=requestAnimationFrame(()=>S(e)),r=setTimeout(()=>S(null),600);return()=>{cancelAnimationFrame(s),clearTimeout(r)}}}},[A,e]);let E=(e,t)=>{y(!0),w(s=>({...s,[e]:t}))};return(0,r.jsxs)("div",{className:"section-gap",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsxs)("h1",{className:"type-title text-text-primary flex items-center gap-3",children:[(0,r.jsx)(n.A,{className:"w-6 h-6 text-accent-primary flex-shrink-0"}),"Packet History"]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 sm:gap-4",children:[b&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)(l.A,{className:"w-2 h-2 fill-accent-success text-accent-success animate-pulse"}),(0,r.jsx)("span",{className:"text-text-muted",children:"Live"})]}),(0,r.jsxs)("button",{onClick:()=>v(!b),className:(0,d.A)("px-3 py-1.5 sm:px-4 sm:py-2 rounded-lg text-sm font-medium transition-all duration-200","flex items-center gap-2 border",b?"bg-accent-success/20 text-accent-success border-accent-success/30":"bg-bg-subtle text-text-muted border-border-subtle hover:bg-bg-elevated"),children:[(0,r.jsx)(c.A,{className:(0,d.A)("w-4 h-4",b&&"animate-spin")}),(0,r.jsx)("span",{className:"hidden xs:inline",children:b?"Live":"Paused"})]})]})]}),(0,r.jsxs)("div",{className:"glass-card p-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,r.jsx)(i,{className:"w-5 h-5 text-accent-primary"}),(0,r.jsx)("span",{className:"text-text-primary font-medium",children:"Filters"}),(void 0!==_.type||void 0!==_.route)&&(0,r.jsxs)("button",{onClick:()=>{y(!0),w({limit:100})},className:"ml-auto text-xs text-text-muted hover:text-text-primary flex items-center gap-1",children:[(0,r.jsx)(o.A,{className:"w-3 h-3"})," Clear"]})]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-text-muted mb-1",children:"Packet Type"}),(0,r.jsxs)("select",{value:_.type??"",onChange:e=>E("type",e.target.value?Number(e.target.value):void 0),className:"bg-bg-subtle border border-border-subtle rounded-lg px-3 py-2 text-sm text-text-primary focus:outline-none focus:border-accent-primary/50",children:[(0,r.jsx)("option",{value:"",children:"All Types"}),Object.entries(x.x).map(([e,t])=>(0,r.jsx)("option",{value:e,children:t},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-text-muted mb-1",children:"Route Type"}),(0,r.jsxs)("select",{value:_.route??"",onChange:e=>E("route",e.target.value?Number(e.target.value):void 0),className:"bg-bg-subtle border border-border-subtle rounded-lg px-3 py-2 text-sm text-text-primary focus:outline-none focus:border-accent-primary/50",children:[(0,r.jsx)("option",{value:"",children:"All Routes"}),Object.entries(x.C).map(([e,t])=>(0,r.jsx)("option",{value:e,children:t},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-xs text-text-muted mb-1",children:"Limit"}),(0,r.jsxs)("select",{value:_.limit??100,onChange:e=>E("limit",Number(e.target.value)),className:"bg-bg-subtle border border-border-subtle rounded-lg px-3 py-2 text-sm text-text-primary focus:outline-none focus:border-accent-primary/50",children:[(0,r.jsx)("option",{value:50,children:"50"}),(0,r.jsx)("option",{value:100,children:"100"}),(0,r.jsx)("option",{value:200,children:"200"}),(0,r.jsx)("option",{value:500,children:"500"})]})]})]})]}),(0,r.jsxs)("div",{className:"glass-card overflow-hidden",children:[(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{className:"border-b border-border-subtle",children:[(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"Time"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"Type"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"Route"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"RSSI"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"SNR"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"Length"}),(0,r.jsx)("th",{className:"text-left py-3 px-4 text-xs font-medium text-text-muted uppercase tracking-wider",children:"Status"})]})}),(0,r.jsx)("tbody",{className:"divide-y divide-border-subtle/50",children:s&&0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"text-center py-12 text-text-muted",children:"Loading packets..."})}):0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:7,className:"text-center py-12 text-text-muted",children:"No packets found"})}):e.map((e,t)=>{let s=e.id??e.packet_hash??String(t),a=(e.payload_type_name||(0,m.wv)(e.payload_type??e.type)).toLowerCase().includes("advert");return(0,r.jsx)(g,{packet:e,index:t,onClick:N,isFlashing:a&&T===s},s)})})]})}),(0,r.jsxs)("div",{className:"px-4 py-3 border-t border-border-subtle text-sm text-text-muted",children:["Showing ",e.length," packets"]})]}),j&&(0,r.jsx)(k,{packet:j,onClose:()=>N(null)})]})}},91958:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(78340).A)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},94514:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(78340).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])}},e=>{_N_E=e(e.s=56181)}]);