(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{6296:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},13364:(e,t,s)=>{"use strict";function a(e){if(e<60)return`${Math.floor(e)}s`;let t=Math.floor(e/86400),s=Math.floor(e%86400/3600),a=Math.floor(e%3600/60),r=[];return t>0&&r.push(`${t}d`),s>0&&r.push(`${s}h`),(a>0||0===r.length)&&r.push(`${a}m`),r.join(" ")}function r(e){let t=Date.now()/1e3-e;return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`}function n(e){return new Date(1e3*e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}function i(e){return new Date(1e3*e).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}function l(e){return`${(e/1e6).toFixed(3)} MHz`}function c(e){return`${(e/1e3).toFixed(1)} kHz`}s.d(t,{$o:()=>c,QR:()=>l,Y0:()=>a,fU:()=>i,fw:()=>r,r6:()=>n})},17561:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var a=s(95155),r=s(12115),n=s(83278),i=s(89363),l=s(46029),c=s(66669),o=s(78340);let d=(0,o.A)("antenna",[["path",{d:"M2 12 7 2",key:"117k30"}],["path",{d:"m7 12 5-10",key:"1tvx22"}],["path",{d:"m12 12 5-10",key:"ev1o1a"}],["path",{d:"m17 12 5-10",key:"1e4ti3"}],["path",{d:"M4.5 7h15",key:"vlsxkz"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);var u=s(33210),m=s(6296),x=s(94514);let p=(0,o.A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var h=s(66088),g=s(24538),f=s(13364),b=s(64964),y=s(27529),v=s(71731),j=s(29722);let _=[{value:7.8,label:"7.8 kHz"},{value:10.4,label:"10.4 kHz"},{value:15.6,label:"15.6 kHz"},{value:20.8,label:"20.8 kHz"},{value:31.25,label:"31.25 kHz"},{value:41.7,label:"41.7 kHz"},{value:62.5,label:"62.5 kHz"},{value:125,label:"125 kHz"},{value:250,label:"250 kHz"},{value:500,label:"500 kHz"}],k=[5,6,7,8,9,10,11,12],N=[{value:5,label:"4/5"},{value:6,label:"4/6"},{value:7,label:"4/7"},{value:8,label:"4/8"}];function w(){let{stats:e,setMode:t,setDutyCycle:s,fetchStats:o}=(0,n.Pj)(),w=e?.config?.radio,A=e?.config?.repeater,S=e?.config?.duty_cycle,L=e?.node_name||e?.config?.node_name||"Unknown Node",E=A?.mode??"forward",M=S?.enforcement_enabled??!1,[C,$]=(0,r.useState)(!1),[F,z]=(0,r.useState)(""),[T,P]=(0,r.useState)(62.5),[R,I]=(0,r.useState)(7),[D,H]=(0,r.useState)(5),[O,q]=(0,r.useState)(""),[U,V]=(0,r.useState)(!1),[Y,B]=(0,r.useState)(null),X=(0,r.useRef)(null);(0,r.useEffect)(()=>{w&&C&&(z((w.frequency/1e6).toFixed(3)),P(w.bandwidth/1e3),I(w.spreading_factor),H(w.coding_rate),q(String(w.tx_power)))},[w,C]);let J=(0,r.useMemo)(()=>{if(!w||!C)return!1;let e=w.frequency/1e6,t=w.bandwidth/1e3;return Math.abs((parseFloat(F)||0)-e)>1e-4||T!==t||R!==w.spreading_factor||D!==w.coding_rate||parseInt(O)!==w.tx_power},[w,C,F,T,R,D,O]),Q=(0,r.useCallback)(()=>{$(!1),B(null),w&&(z((w.frequency/1e6).toFixed(3)),P(w.bandwidth/1e3),I(w.spreading_factor),H(w.coding_rate),q(String(w.tx_power)))},[w]);(0,r.useEffect)(()=>{if(!C)return;let e=e=>{X.current&&!X.current.contains(e.target)&&Q()};return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}},[C,Q]);let W=async()=>{V(!0),B(null);try{let e={},t=parseFloat(F),s=w?w.frequency/1e6:0;Math.abs(t-s)>1e-4&&(e.frequency_mhz=t);let a=w?w.bandwidth/1e3:0;T!==a&&(e.bandwidth_khz=T),R!==w?.spreading_factor&&(e.spreading_factor=R),D!==w?.coding_rate&&(e.coding_rate=D);let r=parseInt(O);if(r!==w?.tx_power&&(e.tx_power=r),0===Object.keys(e).length){B({success:!0,message:"No changes to save"}),V(!1);return}let n=await (0,y.VS)(e);if(n.success&&n.data){let e=n.data.applied.join(", "),t=n.data.live_update?" (applied live)":" (restart required)";B({success:!0,message:`Updated: ${e}${t}`}),o(),setTimeout(()=>{$(!1),B(null)},1500)}else B({success:!1,message:n.error||"Failed to save"})}catch(e){B({success:!1,message:String(e)})}finally{V(!1)}};return(0,a.jsxs)("div",{className:"section-gap",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("h1",{className:"type-title text-text-primary flex items-center gap-3",children:[(0,a.jsx)(i.A,{className:"w-6 h-6 text-accent-primary flex-shrink-0"}),"Settings"]}),(0,a.jsx)(v.C,{})]}),(0,a.jsxs)("div",{className:"grid-12",children:[(0,a.jsxs)("div",{className:"col-span-full md:col-span-6 glass-card card-padding",children:[(0,a.jsxs)("h2",{className:"text-lg font-medium text-text-primary mb-4 flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"w-5 h-5 text-accent-primary"}),"Operating Mode"]}),(0,a.jsx)("p",{className:"text-sm text-text-muted mb-4",children:"Control how the repeater handles incoming packets."}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>t("forward"),className:(0,j.A)("w-full p-4 rounded-lg border text-left transition-all duration-200","forward"===E?"bg-accent-success/20 border-accent-success/50 text-accent-success":"bg-bg-subtle border-border-subtle text-text-secondary hover:bg-bg-elevated"),children:[(0,a.jsx)("div",{className:"font-medium",children:"Forward Mode"}),(0,a.jsx)("div",{className:"text-sm opacity-70 mt-1",children:"Receive packets and retransmit them to extend network coverage"})]}),(0,a.jsxs)("button",{onClick:()=>t("monitor"),className:(0,j.A)("w-full p-4 rounded-lg border text-left transition-all duration-200","monitor"===E?"bg-accent-secondary/20 border-accent-secondary/50 text-accent-secondary":"bg-bg-subtle border-border-subtle text-text-secondary hover:bg-bg-elevated"),children:[(0,a.jsx)("div",{className:"font-medium",children:"Monitor Mode"}),(0,a.jsx)("div",{className:"text-sm opacity-70 mt-1",children:"Receive and log packets without retransmitting"})]})]})]}),(0,a.jsxs)("div",{className:"col-span-full md:col-span-6 glass-card card-padding",children:[(0,a.jsxs)("h2",{className:"text-lg font-medium text-text-primary mb-4 flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"w-5 h-5 text-accent-primary"}),"Duty Cycle Enforcement"]}),(0,a.jsx)("p",{className:"text-sm text-text-muted mb-4",children:"Limit airtime to comply with regulations."}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("button",{onClick:()=>s(!0),className:(0,j.A)("w-full p-4 rounded-lg border text-left transition-all duration-200",M?"bg-accent-success/20 border-accent-success/50 text-accent-success":"bg-bg-subtle border-border-subtle text-text-secondary hover:bg-bg-elevated"),children:[(0,a.jsx)("div",{className:"font-medium",children:"Enabled"}),(0,a.jsx)("div",{className:"text-sm opacity-70 mt-1",children:"Enforce airtime limits to comply with regional regulations"})]}),(0,a.jsxs)("button",{onClick:()=>s(!1),className:(0,j.A)("w-full p-4 rounded-lg border text-left transition-all duration-200",M?"bg-bg-subtle border-border-subtle text-text-secondary hover:bg-bg-elevated":"bg-accent-secondary/20 border-accent-secondary/50 text-accent-secondary"),children:[(0,a.jsx)("div",{className:"font-medium",children:"Disabled"}),(0,a.jsx)("div",{className:"text-sm opacity-70 mt-1",children:"No airtime limiting (use with caution)"})]})]})]}),(0,a.jsxs)("div",{ref:X,className:"col-span-full md:col-span-6 glass-card card-padding",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("h2",{className:"text-lg font-medium text-text-primary flex items-center gap-2",children:[(0,a.jsx)(d,{className:"w-5 h-5 text-accent-primary"}),"Radio Configuration"]}),(0,a.jsx)("div",{className:"flex items-center gap-1",children:w&&(C?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:Q,disabled:U,className:(0,j.A)("p-2 rounded-lg transition-colors",U?"text-text-muted cursor-not-allowed":"text-text-muted hover:text-accent-danger hover:bg-accent-danger/10"),title:"Cancel",children:(0,a.jsx)(u.A,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:W,disabled:U||!J,className:(0,j.A)("p-2 rounded-lg transition-colors",U?"text-accent-primary cursor-wait":J?"text-accent-success hover:bg-accent-success/10":"text-text-muted cursor-not-allowed"),title:J?"Save changes":"No changes to save",children:U?(0,a.jsx)(m.A,{className:"w-4 h-4 animate-spin"}):(0,a.jsx)(x.A,{className:"w-4 h-4"})})]}):(0,a.jsx)("button",{onClick:()=>{w&&(z((w.frequency/1e6).toFixed(3)),P(w.bandwidth/1e3),I(w.spreading_factor),H(w.coding_rate),q(String(w.tx_power))),B(null),$(!0)},className:"p-2 rounded-lg transition-colors text-text-muted hover:text-text-primary hover:bg-bg-subtle",title:"Edit radio settings",children:(0,a.jsx)(p,{className:"w-4 h-4"})}))})]}),Y&&(0,a.jsx)("div",{className:(0,j.A)("text-xs mb-3 px-2 py-1.5 rounded-md",Y.success?"text-accent-success bg-accent-success/10":"text-accent-danger bg-accent-danger/10"),children:Y.message}),w?C?(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Frequency (MHz)"}),(0,a.jsx)("input",{type:"number",value:F,onChange:e=>z(e.target.value),step:"0.001",min:"400",max:"930",className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"TX Power (dBm)"}),(0,a.jsx)("input",{type:"number",value:O,onChange:e=>q(e.target.value),min:"-9",max:"22",className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Bandwidth"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("select",{value:T,onChange:e=>P(parseFloat(e.target.value)),className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 pr-8 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50 appearance-none cursor-pointer",children:_.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsx)(h.A,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Spreading Factor"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("select",{value:R,onChange:e=>I(parseInt(e.target.value)),className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 pr-8 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50 appearance-none cursor-pointer",children:k.map(e=>(0,a.jsxs)("option",{value:e,children:["SF",e]},e))}),(0,a.jsx)(h.A,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Coding Rate"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("select",{value:D,onChange:e=>H(parseInt(e.target.value)),className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 pr-8 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50 appearance-none cursor-pointer",children:N.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsx)(h.A,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Preamble"}),(0,a.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:[w.preamble_length," symbols"]})]})]}):(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Frequency"}),(0,a.jsx)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:(0,f.QR)(w.frequency)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"TX Power"}),(0,a.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:[w.tx_power," dBm"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Bandwidth"}),(0,a.jsx)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:(0,f.$o)(w.bandwidth)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Spreading Factor"}),(0,a.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:["SF",w.spreading_factor]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Coding Rate"}),(0,a.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:["4/",w.coding_rate]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Preamble Length"}),(0,a.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:[w.preamble_length," symbols"]})]})]}):(0,a.jsx)("p",{className:"text-text-muted",children:"Loading radio configuration..."})]}),(0,a.jsxs)("div",{className:"col-span-full md:col-span-6 glass-card card-padding",children:[(0,a.jsxs)("h2",{className:"text-lg font-medium text-text-primary mb-4 flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"w-5 h-5 text-accent-primary"}),"Location"]}),A?(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted",children:"Latitude"}),(0,a.jsx)("p",{className:"text-text-primary font-medium mt-1",children:0!==A.latitude?A.latitude.toFixed(6):"Not set"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted",children:"Longitude"}),(0,a.jsx)("p",{className:"text-text-primary font-medium mt-1",children:0!==A.longitude?A.longitude.toFixed(6):"Not set"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted",children:"Advert Interval"}),(0,a.jsx)("p",{className:"text-text-primary font-medium mt-1",children:A.send_advert_interval_hours>0?`${A.send_advert_interval_hours}h`:"Disabled"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"text-sm text-text-muted",children:"Score-based TX"}),(0,a.jsx)("p",{className:"text-text-primary font-medium mt-1",children:A.use_score_for_tx?"Enabled":"Disabled"})]})]}):(0,a.jsx)("p",{className:"text-text-muted",children:"Loading location settings..."})]}),(0,a.jsxs)("div",{className:"col-span-full glass-card card-padding",children:[(0,a.jsxs)("h2",{className:"type-subheading text-text-primary mb-4 flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"w-5 h-5 text-accent-primary"}),"Node Information"]}),e?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"type-label text-text-muted",children:"Node Name"}),(0,a.jsx)("p",{className:"type-body text-text-primary mt-1",children:L})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"type-label text-text-muted",children:"Version"}),(0,a.jsxs)("p",{className:"type-data text-text-primary mt-1",children:["v",e.version]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"type-label text-text-muted",children:"Core Version"}),(0,a.jsxs)("p",{className:"type-data text-text-primary mt-1",children:["v",e.core_version]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"type-label text-text-muted",children:"Local Hash"}),(0,a.jsx)("div",{className:"mt-1",children:e.local_hash?(0,a.jsx)(b.Q,{hash:e.local_hash,size:"sm"}):(0,a.jsx)("span",{className:"type-data-sm text-text-muted",children:"N/A"})})]})]}),e.public_key&&(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-border-subtle",children:[(0,a.jsx)("span",{className:"type-label text-text-muted",children:"Public Key"}),(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(b.Q,{hash:e.public_key,prefixLength:12,suffixLength:8})})]})]}):(0,a.jsx)("p",{className:"text-text-muted",children:"Loading node information..."})]})]})]})}},24538:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},27529:(e,t,s)=>{"use strict";s.d(t,{A_:()=>u,Fz:()=>h,GT:()=>n,He:()=>b,Nw:()=>o,Ty:()=>p,V0:()=>l,VS:()=>f,ao:()=>i,bx:()=>d,f3:()=>m,iY:()=>x,w7:()=>g});let a=s(41463).env.NEXT_PUBLIC_API_URL||"";async function r(e,t){let s=`${a}${e}`,r={};if(t?.headers){let e=t.headers;e instanceof Headers?e.forEach((e,t)=>{r[t]=e}):Array.isArray(e)?e.forEach(([e,t])=>{r[e]=t}):Object.assign(r,e)}t?.body&&(r["Content-Type"]="application/json");let n=await fetch(s,{...t,headers:r});if(!n.ok)throw Error(`API error: ${n.status} ${n.statusText}`);return n.json()}async function n(){return r("/api/stats")}async function i(){return r("/api/logs")}async function l(e=100){return r(`/api/recent_packets?limit=${e}`)}async function c(e){let t=Math.max(e.limit||1e3,5e3),s=await l(t);if(!s.success||!s.data)return s;let a=s.data;return void 0!==e.type&&(a=a.filter(t=>(t.type??t.payload_type)===e.type)),void 0!==e.route&&(a=a.filter(t=>(t.route??t.route_type)===e.route)),e.start_timestamp&&(a=a.filter(t=>t.timestamp>=e.start_timestamp)),e.end_timestamp&&(a=a.filter(t=>t.timestamp<=e.end_timestamp)),e.limit&&a.length>e.limit&&(a=a.slice(0,e.limit)),{success:!0,data:a,count:a.length}}async function o(e=24){return r(`/api/packet_type_graph_data?hours=${e}`)}async function d(e=24){return r(`/api/noise_floor_chart_data?hours=${e}`)}async function u(){return r("/api/hardware_stats")}async function m(){return r("/api/send_advert",{method:"POST",body:"{}"})}async function x(e){return r("/api/set_mode",{method:"POST",body:JSON.stringify({mode:e})})}async function p(e){return r("/api/set_duty_cycle",{method:"POST",body:JSON.stringify({enabled:e})})}async function h(e=20,t=20){try{let s=Math.floor(Date.now()/1e3),a=s-60*e,r=60*e/t,n=await c({start_timestamp:a,end_timestamp:s,limit:5e3});if(!n.success||!n.data)return{success:!1,error:n.error||"Failed to fetch packets"};let i=n.data,l=()=>{let e=[];for(let s=0;s<t;s++)e.push({bucket:s,start:a+s*r,end:a+(s+1)*r,count:0,avg_snr:0,avg_rssi:0});return e},o=l(),d=l(),u=l(),m=l(),x=o.map(()=>({snr:0,rssi:0,count:0}));for(let e of i){let s=Math.floor((e.timestamp-a)/r);if(s<0||s>=t)continue;let n=e.packet_origin;"tx_local"===n?d[s].count++:"tx_forward"===n||e.transmitted?u[s].count++:e.drop_reason&&m[s].count++,"tx_local"!==n&&(o[s].count++,x[s].snr+=e.snr||0,x[s].rssi+=e.rssi||0,x[s].count++)}for(let e=0;e<t;e++)x[e].count>0&&(o[e].avg_snr=x[e].snr/x[e].count,o[e].avg_rssi=x[e].rssi/x[e].count);return{success:!0,data:{time_range_minutes:e,bucket_count:t,bucket_duration_seconds:r,start_time:a,end_time:s,received:o,transmitted:d,forwarded:u,dropped:m}}}catch(e){return{success:!1,error:String(e)}}}async function g(e=24){try{let t=Math.floor(Date.now()/1e3),s=t-3600*e,[a,r]=await Promise.all([c({start_timestamp:s,end_timestamp:t,limit:5e4}),n()]);if(!a.success||!a.data)return{success:!1,error:a.error||"Failed to fetch packets"};let i=a.data,l=r.config?.radio?.spreading_factor||8,o=1e3*(r.config?.radio?.bandwidth||125),d=[];for(let t=0;t<e;t++)d.push({t:(s+3600*t)*1e3,tx_airtime_ms:0,rx_airtime_ms:0,tx_pkts:0,rx_pkts_ok:0,tx_util_pct:0,rx_util_decoded_pct:0,radio_activity_pct:0,avg_rx_airtime_ms_per_pkt:0,avg_tx_airtime_ms_per_pkt:0});for(let t of i){let a=Math.floor((t.timestamp-s)/3600);if(a<0||a>=e)continue;let r=t.length||t.payload_length||32,n=function(e,t=8,s=125e3){let a=Math.pow(2,t)/(s/1e3);return 8*a+(e+4.25)*8*a}(r,l,o),i=t.packet_origin;"tx_local"===i||"tx_forward"===i||t.transmitted?(d[a].tx_airtime_ms+=n,d[a].tx_pkts++):(d[a].rx_airtime_ms+=n,d[a].rx_pkts_ok++)}for(let e of d)e.tx_util_pct=e.tx_airtime_ms/36e5*100,e.rx_util_decoded_pct=e.rx_airtime_ms/36e5*100,e.radio_activity_pct=(e.tx_airtime_ms+e.rx_airtime_ms)/36e5*100,e.rx_pkts_ok>0&&(e.avg_rx_airtime_ms_per_pkt=e.rx_airtime_ms/e.rx_pkts_ok),e.tx_pkts>0&&(e.avg_tx_airtime_ms_per_pkt=e.tx_airtime_ms/e.tx_pkts);return{success:!0,data:{bins:d,bin_duration_seconds:3600,hours:e,anomaly_counters:{missing_airtime_ms:0,outlier_bins:0}}}}catch(e){return{success:!1,error:String(e)}}}async function f(e){return r("/api/update_radio_config",{method:"POST",body:JSON.stringify(e)})}async function b(e){return r("/api/set_log_level",{method:"POST",body:JSON.stringify({level:e})})}},29722:(e,t,s)=>{"use strict";function a(){for(var e,t,s=0,a="",r=arguments.length;s<r;s++)(e=arguments[s])&&(t=function e(t){var s,a,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(a=e(t[s]))&&(r&&(r+=" "),r+=a)}else for(a in t)t[a]&&(r&&(r+=" "),r+=a);return r}(e))&&(a&&(a+=" "),a+=t);return a}s.d(t,{$:()=>a,A:()=>r});let r=a},33210:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},41593:(e,t,s)=>{Promise.resolve().then(s.bind(s,17561))},46029:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("radio",[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},64964:(e,t,s)=>{"use strict";s.d(t,{Q:()=>c});var a=s(95155),r=s(12115),n=s(94514);let i=(0,s(78340).A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var l=s(29722);function c({hash:e,prefixLength:t=8,suffixLength:s=6,full:c=!1,className:o,size:d="md"}){let[u,m]=(0,r.useState)(!1),[x,p]=(0,r.useState)(!1),h=(0,r.useRef)(null),g=(0,r.useCallback)(t=>{t.preventDefault(),t.stopPropagation(),h.current&&clearTimeout(h.current);let s=function(e){if((window.isSecureContext||"https:"===window.location.protocol||"localhost"===window.location.hostname)&&navigator.clipboard&&"function"==typeof navigator.clipboard.writeText)return navigator.clipboard.writeText(e).catch(()=>{}),!0;try{let t=window.scrollX,s=window.scrollY,a=document.createElement("textarea");a.value=e,a.style.position="fixed",a.style.left="-9999px",a.style.top="-9999px",a.style.opacity="0",a.style.pointerEvents="none",a.setAttribute("readonly",""),document.body.appendChild(a),a.focus({preventScroll:!0}),a.select(),a.setSelectionRange(0,e.length);let r=document.execCommand("copy");return document.body.removeChild(a),window.scrollTo(t,s),r}catch(e){return console.error("Copy failed:",e),!1}}(e);m(!0),h.current=setTimeout(()=>m(!1),2e3),s||console.warn("Copy may have failed for:",e.slice(0,16)+"...")},[e]),f=c||e.length<=t+s+3?e:`${e.slice(0,t)}â€¦${e.slice(-s)}`;return(0,a.jsxs)("button",{type:"button",onClick:g,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),className:(0,l.A)("inline-flex items-center font-mono rounded-md transition-all duration-200","bg-bg-subtle/80 hover:bg-bg-elevated border border-border-subtle hover:border-border-strong","cursor-pointer select-none","sm"===d?"text-[10px] px-1.5 py-0.5 gap-1":"text-xs px-2 py-1 gap-1.5",o),title:`Click to copy: ${e}`,"aria-label":`Copy hash ${e}`,children:[(0,a.jsx)("span",{className:(0,l.A)("transition-colors duration-200",u?"text-accent-success":"text-text-secondary"),children:f}),(0,a.jsx)("span",{className:(0,l.A)("flex items-center justify-center transition-all duration-200","sm"===d?"w-3 h-3":"w-3.5 h-3.5"),children:u?(0,a.jsx)(n.A,{className:(0,l.A)("text-accent-success","sm"===d?"w-2.5 h-2.5":"w-3 h-3")}):(0,a.jsx)(i,{className:(0,l.A)("transition-opacity duration-200",x?"opacity-70":"opacity-40","sm"===d?"w-2.5 h-2.5":"w-3 h-3")})})]})}},66088:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},66669:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]])},71731:(e,t,s)=>{"use strict";s.d(t,{C:()=>o,W:()=>d});var a=s(95155),r=s(12115),n=s(29722);let i=[{id:"default",src:"/images/bg.jpg",theme:null},{id:"amber",src:"/images/bg-amber.jpg",theme:"amber"},{id:"grey",src:"/images/bg-grey.jpg",theme:"grey"},{id:"black",src:"/images/bg-black.jpg",theme:"black"},{id:"flora",src:"/images/bg-flora.jpg",theme:"flora"}],l="pymc-background",c="pymc-bg-brightness";function o(){let[e,t]=(0,r.useState)("default"),[s,o]=(0,r.useState)(80),[d,u]=(0,r.useState)(!1),[m,x]=(0,r.useState)(!1),[p,h]=(0,r.useState)(!1),g=(0,r.useRef)(null),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{x(!0);let e=localStorage.getItem(l),s=localStorage.getItem(c);if(s){let e=parseInt(s,10);!isNaN(e)&&e>=0&&e<=100&&o(e)}if(e&&i.some(t=>t.id===e)){t(e);let s=i.find(t=>t.id===e);s?.theme&&document.documentElement.setAttribute("data-theme",s.theme)}},[]);let b=e=>{o(e),localStorage.setItem(c,String(e)),window.dispatchEvent(new CustomEvent("brightness-change",{detail:e}))};if(!m)return(0,a.jsx)("div",{className:"flex gap-2"});let y=e=>{if(!f.current)return s;let t=f.current.y-e;return Math.round(Math.max(0,Math.min(100,f.current.brightness+t/200*100)))};return(0,a.jsx)("div",{className:"flex gap-2 items-center flex-shrink-0",children:i.map(r=>{let c=e===r.id,o=c&&(d||p);return(0,a.jsxs)("div",{ref:c?g:void 0,className:(0,n.A)("relative rounded-md overflow-hidden transition-all duration-300 ease-out","ring-offset-1 ring-offset-bg-body w-10 h-10",c?"ring-2 ring-accent-primary scale-105 cursor-ns-resize":"ring-1 ring-white/20 hover:ring-white/40 opacity-70 hover:opacity-100 cursor-pointer"),onMouseEnter:()=>c&&u(!0),onMouseLeave:()=>!p&&u(!1),onClick:()=>{var e;let s;return!c&&(t(e=r.id),u(!0),localStorage.setItem(l,e),s=i.find(t=>t.id===e),void(s?.theme?document.documentElement.setAttribute("data-theme",s.theme):document.documentElement.removeAttribute("data-theme"),window.dispatchEvent(new CustomEvent("background-change",{detail:e}))))},onTouchStart:e=>{if(!c)return;e.preventDefault(),f.current={y:e.touches[0].clientY,brightness:s},h(!0),u(!0);let t=e=>{e.preventDefault(),b(y(e.touches[0].clientY))},a=()=>{document.removeEventListener("touchmove",t),document.removeEventListener("touchend",a),f.current=null,h(!1),setTimeout(()=>u(!1),1500)};document.addEventListener("touchmove",t,{passive:!1}),document.addEventListener("touchend",a)},onMouseDown:e=>{if(!c)return;e.preventDefault(),f.current={y:e.clientY,brightness:s},h(!0),u(!0);let t=e=>{b(y(e.clientY))},a=()=>{document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",a),f.current=null,h(!1)};document.addEventListener("mousemove",t),document.addEventListener("mouseup",a)},children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-cover bg-center transition-opacity duration-200",style:{backgroundImage:`url(${r.src})`,opacity:o?.4:1}}),c&&(0,a.jsxs)("div",{className:(0,n.A)("absolute inset-0 transition-opacity duration-200",o?"opacity-100":"opacity-0"),children:[(0,a.jsx)("div",{className:"absolute inset-x-0 bottom-0 bg-black/70 transition-all duration-100 ease-out",style:{height:`${100-s}%`}}),(0,a.jsx)("div",{className:"absolute inset-x-1 h-0.5 bg-white rounded-full shadow-lg transition-all duration-100 ease-out",style:{top:`${100-s}%`}}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,a.jsxs)("span",{className:"text-[10px] font-mono font-bold text-white drop-shadow-lg",children:[s,"%"]})})]})]},r.id)})})}function d(){let[e,t]=(0,r.useState)("/images/bg.jpg");return(0,r.useEffect)(()=>{let e=localStorage.getItem(l);t((i.find(t=>t.id===e)||i[0]).src);let s=e=>{t((i.find(t=>t.id===e.detail)||i[0]).src)};return window.addEventListener("background-change",s),()=>{window.removeEventListener("background-change",s)}},[]),e}},78340:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var a=s(12115);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:r,className:l="",children:c,iconNode:o,...d},u)=>(0,a.createElement)("svg",{ref:u,...i,width:t,height:t,stroke:e,strokeWidth:r?24*Number(s)/Number(t):s,className:n("lucide",l),...!c&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...o.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(c)?c:[c]])),c=(e,t)=>{let s=(0,a.forwardRef)(({className:s,...i},c)=>(0,a.createElement)(l,{ref:c,iconNode:t,className:n(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...i}));return s.displayName=r(e),s}},83278:(e,t,s)=>{"use strict";let a;s.d(t,{p5:()=>v,xe:()=>y,Sg:()=>b,rf:()=>f,XL:()=>g,jg:()=>p,fL:()=>h,Xb:()=>m,T:()=>x,Ni:()=>j,J3:()=>d,B7:()=>u,Pj:()=>o});var r=s(12115);let n=e=>{let t,s=new Set,a=(e,a)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=(null!=a?a:"object"!=typeof r||null===r)?r:Object.assign({},t,r),s.forEach(s=>s(t,e))}},r=()=>t,n={setState:a,getState:r,getInitialState:()=>i,subscribe:e=>(s.add(e),()=>s.delete(e))},i=t=e(a,r,n);return n},i=e=>{let t=e?n(e):n,s=e=>(function(e,t=e=>e){let s=r.useSyncExternalStore(e.subscribe,r.useCallback(()=>t(e.getState()),[e,t]),r.useCallback(()=>t(e.getInitialState()),[e,t]));return r.useDebugValue(s),s})(t,e);return Object.assign(s,t),s};var l=s(27529);let c=(a=(e,t)=>({stats:null,statsLoading:!1,statsError:null,packets:[],packetsLoading:!1,packetsError:null,lastPacketTimestamp:0,logs:[],logsLoading:!1,liveMode:!0,flashReceived:0,flashAdvert:0,fetchStats:async()=>{e({statsLoading:!0,statsError:null});try{let t=await l.GT();e({stats:t,statsLoading:!1})}catch(t){e({statsError:t instanceof Error?t.message:"Failed to fetch stats",statsLoading:!1})}},fetchPackets:async(s=50)=>{e({packetsLoading:!0,packetsError:null});try{let a=await l.V0(s);if(a.success&&a.data){let s=a.data,{lastPacketTimestamp:r}=t(),n=s.length>0?Math.max(...s.map(e=>e.timestamp??0)):0;n>r&&r>0&&e({flashReceived:t().flashReceived+1}),e({packets:s,packetsLoading:!1,lastPacketTimestamp:n||r})}else e({packetsError:a.error||"Failed to fetch packets",packetsLoading:!1})}catch(t){e({packetsError:t instanceof Error?t.message:"Failed to fetch packets",packetsLoading:!1})}},fetchLogs:async()=>{e({logsLoading:!0});try{let t=await l.ao();e({logs:t.logs,logsLoading:!1})}catch(t){e({logsLoading:!1})}},setLiveMode:t=>{e({liveMode:t})},setMode:async e=>{try{(await l.iY(e)).success&&await t().fetchStats()}catch(e){console.error("Failed to set mode:",e)}},setDutyCycle:async e=>{try{(await l.Ty(e)).success&&t().fetchStats()}catch(e){console.error("Failed to set duty cycle:",e)}},sendAdvert:async()=>{try{let s=await l.f3();return s.success&&e({flashAdvert:t().flashAdvert+1}),s.success}catch(e){return console.error("Failed to send advert:",e),!1}},triggerFlashReceived:()=>{e({flashReceived:t().flashReceived+1})},triggerFlashAdvert:()=>{e({flashAdvert:t().flashAdvert+1})}}))?i(a):i,o=c,d=()=>c(e=>e.stats),u=()=>c(e=>e.statsError),m=()=>c(e=>e.packets),x=()=>c(e=>e.packetsLoading),p=()=>c(e=>e.logs),h=()=>c(e=>e.logsLoading),g=()=>c(e=>e.liveMode),f=()=>c(e=>e.flashReceived),b=()=>c(e=>e.flashAdvert),y=()=>c(e=>e.fetchPackets),v=()=>c(e=>e.fetchLogs),j=()=>c(e=>e.setLiveMode)},89363:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},94514:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(78340).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])}},e=>{_N_E=e(e.s=41593)}]);