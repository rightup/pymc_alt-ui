(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{6296:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(78340).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},13364:(e,t,a)=>{"use strict";function s(e){if(e<60)return`${Math.floor(e)}s`;let t=Math.floor(e/86400),a=Math.floor(e%86400/3600),s=Math.floor(e%3600/60),r=[];return t>0&&r.push(`${t}d`),a>0&&r.push(`${a}h`),(s>0||0===r.length)&&r.push(`${s}m`),r.join(" ")}function r(e){let t=Date.now()/1e3-e;return t<60?"just now":t<3600?`${Math.floor(t/60)}m ago`:t<86400?`${Math.floor(t/3600)}h ago`:`${Math.floor(t/86400)}d ago`}function n(e){return new Date(1e3*e).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1})}function i(e){return new Date(1e3*e).toLocaleTimeString("en-US",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}function l(e){return`${(e/1e6).toFixed(3)} MHz`}function c(e){return`${(e/1e3).toFixed(1)} kHz`}a.d(t,{$o:()=>c,QR:()=>l,Y0:()=>s,fU:()=>i,fw:()=>r,r6:()=>n})},17561:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var s=a(95155),r=a(12115),n=a(83278),i=a(89363),l=a(46029),c=a(66669),o=a(78340);let d=(0,o.A)("antenna",[["path",{d:"M2 12 7 2",key:"117k30"}],["path",{d:"m7 12 5-10",key:"1tvx22"}],["path",{d:"m12 12 5-10",key:"ev1o1a"}],["path",{d:"m17 12 5-10",key:"1e4ti3"}],["path",{d:"M4.5 7h15",key:"vlsxkz"}],["path",{d:"M12 16v6",key:"c8a4gj"}]]);var m=a(33210),u=a(6296),x=a(94514);let p=(0,o.A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var h=a(66088),g=a(24538),f=a(13364),b=a(64964),y=a(27529),v=a(71731),j=a(29722);let _=[{value:7.8,label:"7.8 kHz"},{value:10.4,label:"10.4 kHz"},{value:15.6,label:"15.6 kHz"},{value:20.8,label:"20.8 kHz"},{value:31.25,label:"31.25 kHz"},{value:41.7,label:"41.7 kHz"},{value:62.5,label:"62.5 kHz"},{value:125,label:"125 kHz"},{value:250,label:"250 kHz"},{value:500,label:"500 kHz"}],k=[5,6,7,8,9,10,11,12],N=[{value:5,label:"4/5"},{value:6,label:"4/6"},{value:7,label:"4/7"},{value:8,label:"4/8"}];function w(){let{stats:e,setMode:t,setDutyCycle:a,fetchStats:o}=(0,n.Pj)(),w=e?.config?.radio,A=e?.config?.repeater,S=e?.config?.duty_cycle,M=e?.node_name||e?.config?.node_name||"Unknown Node",L=A?.mode??"forward",C=S?.enforcement_enabled??!1,[E,$]=(0,r.useState)(!1),[F,z]=(0,r.useState)(""),[T,P]=(0,r.useState)(62.5),[R,I]=(0,r.useState)(7),[H,O]=(0,r.useState)(5),[q,D]=(0,r.useState)(""),[U,B]=(0,r.useState)(!1),[V,X]=(0,r.useState)(null),J=(0,r.useRef)(null);(0,r.useEffect)(()=>{w&&E&&(z((w.frequency/1e6).toFixed(3)),P(w.bandwidth/1e3),I(w.spreading_factor),O(w.coding_rate),D(String(w.tx_power)))},[w,E]);let Q=(0,r.useMemo)(()=>{if(!w||!E)return!1;let e=w.frequency/1e6,t=w.bandwidth/1e3;return Math.abs((parseFloat(F)||0)-e)>1e-4||T!==t||R!==w.spreading_factor||H!==w.coding_rate||parseInt(q)!==w.tx_power},[w,E,F,T,R,H,q]),W=(0,r.useCallback)(()=>{$(!1),X(null),w&&(z((w.frequency/1e6).toFixed(3)),P(w.bandwidth/1e3),I(w.spreading_factor),O(w.coding_rate),D(String(w.tx_power)))},[w]);(0,r.useEffect)(()=>{if(!E)return;let e=e=>{J.current&&!J.current.contains(e.target)&&W()};return document.addEventListener("mouseup",e),()=>{document.removeEventListener("mouseup",e)}},[E,W]);let Y=async()=>{B(!0),X(null);try{let e={},t=parseFloat(F),a=w?w.frequency/1e6:0;Math.abs(t-a)>1e-4&&(e.frequency_mhz=t);let s=w?w.bandwidth/1e3:0;T!==s&&(e.bandwidth_khz=T),R!==w?.spreading_factor&&(e.spreading_factor=R),H!==w?.coding_rate&&(e.coding_rate=H);let r=parseInt(q);if(r!==w?.tx_power&&(e.tx_power=r),0===Object.keys(e).length){X({success:!0,message:"No changes to save"}),B(!1);return}let n=await (0,y.VS)(e);if(n.success&&n.data){let e=n.data.applied.join(", "),t=n.data.live_update?" (applied live)":" (restart required)";X({success:!0,message:`Updated: ${e}${t}`}),o(),setTimeout(()=>{$(!1),X(null)},1500)}else X({success:!1,message:n.error||"Failed to save"})}catch(e){X({success:!1,message:String(e)})}finally{B(!1)}};return(0,s.jsxs)("div",{className:"section-gap",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between",children:[(0,s.jsxs)("h1",{className:"type-title text-text-primary flex items-center gap-3",children:[(0,s.jsx)(i.A,{className:"w-6 h-6 text-accent-primary flex-shrink-0"}),"Settings"]}),(0,s.jsx)(v.C,{})]}),(0,s.jsxs)("div",{className:"grid-12",children:[(0,s.jsxs)("div",{className:"col-span-full md:col-span-6 glass-card card-padding",children:[(0,s.jsxs)("h2",{className:"text-lg font-medium text-text-primary mb-4 flex items-center gap-2",children:[(0,s.jsx)(l.A,{className:"w-5 h-5 text-accent-primary"}),"Operating Mode"]}),(0,s.jsx)("p",{className:"text-sm text-text-muted mb-4",children:"Control how the repeater handles incoming packets."}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("button",{onClick:()=>t("forward"),className:(0,j.A)("w-full p-4 rounded-lg border text-left transition-all duration-200","forward"===L?"bg-accent-success/20 border-accent-success/50 text-accent-success":"bg-bg-subtle border-border-subtle text-text-secondary hover:bg-bg-elevated"),children:[(0,s.jsx)("div",{className:"font-medium",children:"Forward Mode"}),(0,s.jsx)("div",{className:"text-sm opacity-70 mt-1",children:"Receive packets and retransmit them to extend network coverage"})]}),(0,s.jsxs)("button",{onClick:()=>t("monitor"),className:(0,j.A)("w-full p-4 rounded-lg border text-left transition-all duration-200","monitor"===L?"bg-accent-secondary/20 border-accent-secondary/50 text-accent-secondary":"bg-bg-subtle border-border-subtle text-text-secondary hover:bg-bg-elevated"),children:[(0,s.jsx)("div",{className:"font-medium",children:"Monitor Mode"}),(0,s.jsx)("div",{className:"text-sm opacity-70 mt-1",children:"Receive and log packets without retransmitting"})]})]})]}),(0,s.jsxs)("div",{className:"col-span-full md:col-span-6 glass-card card-padding",children:[(0,s.jsxs)("h2",{className:"text-lg font-medium text-text-primary mb-4 flex items-center gap-2",children:[(0,s.jsx)(c.A,{className:"w-5 h-5 text-accent-primary"}),"Duty Cycle Enforcement"]}),(0,s.jsx)("p",{className:"text-sm text-text-muted mb-4",children:"Limit airtime to comply with regulations."}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("button",{onClick:()=>a(!0),className:(0,j.A)("w-full p-4 rounded-lg border text-left transition-all duration-200",C?"bg-accent-success/20 border-accent-success/50 text-accent-success":"bg-bg-subtle border-border-subtle text-text-secondary hover:bg-bg-elevated"),children:[(0,s.jsx)("div",{className:"font-medium",children:"Enabled"}),(0,s.jsx)("div",{className:"text-sm opacity-70 mt-1",children:"Enforce airtime limits to comply with regional regulations"})]}),(0,s.jsxs)("button",{onClick:()=>a(!1),className:(0,j.A)("w-full p-4 rounded-lg border text-left transition-all duration-200",C?"bg-bg-subtle border-border-subtle text-text-secondary hover:bg-bg-elevated":"bg-accent-secondary/20 border-accent-secondary/50 text-accent-secondary"),children:[(0,s.jsx)("div",{className:"font-medium",children:"Disabled"}),(0,s.jsx)("div",{className:"text-sm opacity-70 mt-1",children:"No airtime limiting (use with caution)"})]})]})]}),(0,s.jsxs)("div",{ref:J,className:"col-span-full md:col-span-6 glass-card card-padding",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsxs)("h2",{className:"text-lg font-medium text-text-primary flex items-center gap-2",children:[(0,s.jsx)(d,{className:"w-5 h-5 text-accent-primary"}),"Radio Configuration"]}),(0,s.jsx)("div",{className:"flex items-center gap-1",children:w&&(E?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:W,disabled:U,className:(0,j.A)("p-2 rounded-lg transition-colors",U?"text-text-muted cursor-not-allowed":"text-text-muted hover:text-accent-danger hover:bg-accent-danger/10"),title:"Cancel",children:(0,s.jsx)(m.A,{className:"w-4 h-4"})}),(0,s.jsx)("button",{onClick:Y,disabled:U||!Q,className:(0,j.A)("p-2 rounded-lg transition-colors",U?"text-accent-primary cursor-wait":Q?"text-accent-success hover:bg-accent-success/10":"text-text-muted cursor-not-allowed"),title:Q?"Save changes":"No changes to save",children:U?(0,s.jsx)(u.A,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(x.A,{className:"w-4 h-4"})})]}):(0,s.jsx)("button",{onClick:()=>{w&&(z((w.frequency/1e6).toFixed(3)),P(w.bandwidth/1e3),I(w.spreading_factor),O(w.coding_rate),D(String(w.tx_power))),X(null),$(!0)},className:"p-2 rounded-lg transition-colors text-text-muted hover:text-text-primary hover:bg-bg-subtle",title:"Edit radio settings",children:(0,s.jsx)(p,{className:"w-4 h-4"})}))})]}),V&&(0,s.jsx)("div",{className:(0,j.A)("text-xs mb-3 px-2 py-1.5 rounded-md",V.success?"text-accent-success bg-accent-success/10":"text-accent-danger bg-accent-danger/10"),children:V.message}),w?E?(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Frequency (MHz)"}),(0,s.jsx)("input",{type:"number",value:F,onChange:e=>z(e.target.value),step:"0.001",min:"400",max:"930",className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"TX Power (dBm)"}),(0,s.jsx)("input",{type:"number",value:q,onChange:e=>D(e.target.value),min:"-9",max:"22",className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Bandwidth"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("select",{value:T,onChange:e=>P(parseFloat(e.target.value)),className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 pr-8 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50 appearance-none cursor-pointer",children:_.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,s.jsx)(h.A,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Spreading Factor"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("select",{value:R,onChange:e=>I(parseInt(e.target.value)),className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 pr-8 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50 appearance-none cursor-pointer",children:k.map(e=>(0,s.jsxs)("option",{value:e,children:["SF",e]},e))}),(0,s.jsx)(h.A,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Coding Rate"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("select",{value:H,onChange:e=>O(parseInt(e.target.value)),className:"w-full h-[38px] bg-bg-subtle border border-border-subtle rounded-lg px-3 pr-8 py-2 text-text-primary focus:outline-none focus:ring-2 focus:ring-accent-primary/50 appearance-none cursor-pointer",children:N.map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,s.jsx)(h.A,{className:"absolute right-2.5 top-1/2 -translate-y-1/2 w-4 h-4 text-text-muted pointer-events-none"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Preamble"}),(0,s.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:[w.preamble_length," symbols"]})]})]}):(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Frequency"}),(0,s.jsx)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:(0,f.QR)(w.frequency)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"TX Power"}),(0,s.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:[w.tx_power," dBm"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Bandwidth"}),(0,s.jsx)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:(0,f.$o)(w.bandwidth)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Spreading Factor"}),(0,s.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:["SF",w.spreading_factor]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Coding Rate"}),(0,s.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:["4/",w.coding_rate]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted block mb-1",children:"Preamble Length"}),(0,s.jsxs)("p",{className:"text-text-primary font-medium h-[38px] flex items-center",children:[w.preamble_length," symbols"]})]})]}):(0,s.jsx)("p",{className:"text-text-muted",children:"Loading radio configuration..."})]}),(0,s.jsxs)("div",{className:"col-span-full md:col-span-6 glass-card card-padding",children:[(0,s.jsxs)("h2",{className:"text-lg font-medium text-text-primary mb-4 flex items-center gap-2",children:[(0,s.jsx)(g.A,{className:"w-5 h-5 text-accent-primary"}),"Location"]}),A?(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted",children:"Latitude"}),(0,s.jsx)("p",{className:"text-text-primary font-medium mt-1",children:0!==A.latitude?A.latitude.toFixed(6):"Not set"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted",children:"Longitude"}),(0,s.jsx)("p",{className:"text-text-primary font-medium mt-1",children:0!==A.longitude?A.longitude.toFixed(6):"Not set"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted",children:"Advert Interval"}),(0,s.jsx)("p",{className:"text-text-primary font-medium mt-1",children:A.send_advert_interval_hours>0?`${A.send_advert_interval_hours}h`:"Disabled"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"text-sm text-text-muted",children:"Score-based TX"}),(0,s.jsx)("p",{className:"text-text-primary font-medium mt-1",children:A.use_score_for_tx?"Enabled":"Disabled"})]})]}):(0,s.jsx)("p",{className:"text-text-muted",children:"Loading location settings..."})]}),(0,s.jsxs)("div",{className:"col-span-full glass-card card-padding",children:[(0,s.jsxs)("h2",{className:"type-subheading text-text-primary mb-4 flex items-center gap-2",children:[(0,s.jsx)(l.A,{className:"w-5 h-5 text-accent-primary"}),"Node Information"]}),e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"type-label text-text-muted",children:"Node Name"}),(0,s.jsx)("p",{className:"type-body text-text-primary mt-1",children:M})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"type-label text-text-muted",children:"Version"}),(0,s.jsxs)("p",{className:"type-data text-text-primary mt-1",children:["v",e.version]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"type-label text-text-muted",children:"Core Version"}),(0,s.jsxs)("p",{className:"type-data text-text-primary mt-1",children:["v",e.core_version]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"type-label text-text-muted",children:"Local Hash"}),(0,s.jsx)("div",{className:"mt-1",children:e.local_hash?(0,s.jsx)(b.Q,{hash:e.local_hash,size:"sm"}):(0,s.jsx)("span",{className:"type-data-sm text-text-muted",children:"N/A"})})]})]}),e.public_key&&(0,s.jsxs)("div",{className:"mt-4 pt-4 border-t border-border-subtle",children:[(0,s.jsx)("span",{className:"type-label text-text-muted",children:"Public Key"}),(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsx)(b.Q,{hash:e.public_key,prefixLength:12,suffixLength:8})})]})]}):(0,s.jsx)("p",{className:"text-text-muted",children:"Loading node information..."})]})]})]})}},24538:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(78340).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},27529:(e,t,a)=>{"use strict";a.d(t,{A_:()=>m,Fz:()=>h,GT:()=>n,He:()=>b,Nw:()=>o,Ty:()=>p,V0:()=>l,VS:()=>f,ao:()=>i,bx:()=>d,f3:()=>u,iY:()=>x,w7:()=>g});let s=a(41463).env.NEXT_PUBLIC_API_URL||"";async function r(e,t){let a=`${s}${e}`,r={};if(t?.headers){let e=t.headers;e instanceof Headers?e.forEach((e,t)=>{r[t]=e}):Array.isArray(e)?e.forEach(([e,t])=>{r[e]=t}):Object.assign(r,e)}t?.body&&(r["Content-Type"]="application/json");let n=await fetch(a,{...t,headers:r});if(!n.ok)throw Error(`API error: ${n.status} ${n.statusText}`);return n.json()}async function n(){return r("/api/stats")}async function i(){return r("/api/logs")}async function l(e=100){return r(`/api/recent_packets?limit=${e}`)}async function c(e){let t=Math.max(e.limit||1e3,5e3),a=await l(t);if(!a.success||!a.data)return a;let s=a.data;return void 0!==e.type&&(s=s.filter(t=>(t.type??t.payload_type)===e.type)),void 0!==e.route&&(s=s.filter(t=>(t.route??t.route_type)===e.route)),e.start_timestamp&&(s=s.filter(t=>t.timestamp>=e.start_timestamp)),e.end_timestamp&&(s=s.filter(t=>t.timestamp<=e.end_timestamp)),e.limit&&s.length>e.limit&&(s=s.slice(0,e.limit)),{success:!0,data:s,count:s.length}}async function o(e=24){return r(`/api/packet_type_graph_data?hours=${e}`)}async function d(e=24){return r(`/api/noise_floor_chart_data?hours=${e}`)}async function m(){return r("/api/hardware_stats")}async function u(){return r("/api/send_advert",{method:"POST",body:"{}"})}async function x(e){return r("/api/set_mode",{method:"POST",body:JSON.stringify({mode:e})})}async function p(e){return r("/api/set_duty_cycle",{method:"POST",body:JSON.stringify({enabled:e})})}async function h(e=20,t=20){try{let a=Math.floor(Date.now()/1e3),s=a-60*e,r=60*e/t,n=await c({start_timestamp:s,end_timestamp:a,limit:5e3});if(!n.success||!n.data)return{success:!1,error:n.error||"Failed to fetch packets"};let i=n.data,l=()=>{let e=[];for(let a=0;a<t;a++)e.push({bucket:a,start:s+a*r,end:s+(a+1)*r,count:0,avg_snr:0,avg_rssi:0});return e},o=l(),d=l(),m=l(),u=l(),x=o.map(()=>({snr:0,rssi:0,count:0}));for(let e of i){let a=Math.floor((e.timestamp-s)/r);if(a<0||a>=t)continue;let n=e.packet_origin;"tx_local"===n?d[a].count++:"tx_forward"===n||e.transmitted?m[a].count++:e.drop_reason&&u[a].count++,"tx_local"!==n&&(o[a].count++,x[a].snr+=e.snr||0,x[a].rssi+=e.rssi||0,x[a].count++)}for(let e=0;e<t;e++)x[e].count>0&&(o[e].avg_snr=x[e].snr/x[e].count,o[e].avg_rssi=x[e].rssi/x[e].count);return{success:!0,data:{time_range_minutes:e,bucket_count:t,bucket_duration_seconds:r,start_time:s,end_time:a,received:o,transmitted:d,forwarded:m,dropped:u}}}catch(e){return{success:!1,error:String(e)}}}async function g(e=24){try{let t=Math.floor(Date.now()/1e3),a=t-3600*e,[s,r]=await Promise.all([c({start_timestamp:a,end_timestamp:t,limit:5e4}),n()]);if(!s.success||!s.data)return{success:!1,error:s.error||"Failed to fetch packets"};let i=s.data,l=r.config?.radio?.spreading_factor||8,o=1e3*(r.config?.radio?.bandwidth||125),d=[];for(let t=0;t<e;t++)d.push({t:(a+3600*t)*1e3,tx_airtime_ms:0,rx_airtime_ms:0,tx_pkts:0,rx_pkts_ok:0,tx_util_pct:0,rx_util_decoded_pct:0,radio_activity_pct:0,avg_rx_airtime_ms_per_pkt:0,avg_tx_airtime_ms_per_pkt:0});for(let t of i){let s=Math.floor((t.timestamp-a)/3600);if(s<0||s>=e)continue;let r=t.length||t.payload_length||32,n=function(e,t=8,a=125e3){let s=Math.pow(2,t)/(a/1e3);return 8*s+(e+4.25)*8*s}(r,l,o),i=t.packet_origin;"tx_local"===i||"tx_forward"===i||t.transmitted?(d[s].tx_airtime_ms+=n,d[s].tx_pkts++):(d[s].rx_airtime_ms+=n,d[s].rx_pkts_ok++)}for(let e of d)e.tx_util_pct=e.tx_airtime_ms/36e5*100,e.rx_util_decoded_pct=e.rx_airtime_ms/36e5*100,e.radio_activity_pct=(e.tx_airtime_ms+e.rx_airtime_ms)/36e5*100,e.rx_pkts_ok>0&&(e.avg_rx_airtime_ms_per_pkt=e.rx_airtime_ms/e.rx_pkts_ok),e.tx_pkts>0&&(e.avg_tx_airtime_ms_per_pkt=e.tx_airtime_ms/e.tx_pkts);return{success:!0,data:{bins:d,bin_duration_seconds:3600,hours:e,anomaly_counters:{missing_airtime_ms:0,outlier_bins:0}}}}catch(e){return{success:!1,error:String(e)}}}async function f(e){return r("/api/update_radio_config",{method:"POST",body:JSON.stringify(e)})}async function b(e){return r("/api/set_log_level",{method:"POST",body:JSON.stringify({level:e})})}},29722:(e,t,a)=>{"use strict";function s(){for(var e,t,a=0,s="",r=arguments.length;a<r;a++)(e=arguments[a])&&(t=function e(t){var a,s,r="";if("string"==typeof t||"number"==typeof t)r+=t;else if("object"==typeof t)if(Array.isArray(t)){var n=t.length;for(a=0;a<n;a++)t[a]&&(s=e(t[a]))&&(r&&(r+=" "),r+=s)}else for(s in t)t[s]&&(r&&(r+=" "),r+=s);return r}(e))&&(s&&(s+=" "),s+=t);return s}a.d(t,{$:()=>s,A:()=>r});let r=s},33210:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(78340).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},41593:(e,t,a)=>{Promise.resolve().then(a.bind(a,17561))},46029:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(78340).A)("radio",[["path",{d:"M16.247 7.761a6 6 0 0 1 0 8.478",key:"1fwjs5"}],["path",{d:"M19.075 4.933a10 10 0 0 1 0 14.134",key:"ehdyv1"}],["path",{d:"M4.925 19.067a10 10 0 0 1 0-14.134",key:"1q22gi"}],["path",{d:"M7.753 16.239a6 6 0 0 1 0-8.478",key:"r2q7qm"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},64964:(e,t,a)=>{"use strict";a.d(t,{Q:()=>c});var s=a(95155),r=a(12115),n=a(94514);let i=(0,a(78340).A)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var l=a(29722);function c({hash:e,prefixLength:t=8,suffixLength:a=6,full:c=!1,className:o,size:d="md"}){let[m,u]=(0,r.useState)(!1),[x,p]=(0,r.useState)(!1),h=(0,r.useRef)(null),g=(0,r.useCallback)(t=>{t.preventDefault(),t.stopPropagation(),h.current&&clearTimeout(h.current);let a=function(e){if((window.isSecureContext||"https:"===window.location.protocol||"localhost"===window.location.hostname)&&navigator.clipboard&&"function"==typeof navigator.clipboard.writeText)return navigator.clipboard.writeText(e).catch(()=>{}),!0;try{let t=document.createElement("input");t.setAttribute("type","text"),t.setAttribute("value",e),t.style.position="fixed",t.style.left="0",t.style.top="0",t.style.opacity="0",t.style.pointerEvents="none",document.body.appendChild(t),t.focus(),t.select(),t.setSelectionRange(0,e.length);let a=document.execCommand("copy");return document.body.removeChild(t),a}catch(e){return console.error("Copy failed:",e),!1}}(e);u(!0),h.current=setTimeout(()=>u(!1),2e3),a||console.warn("Copy may have failed for:",e.slice(0,16)+"...")},[e]),f=c||e.length<=t+a+3?e:`${e.slice(0,t)}â€¦${e.slice(-a)}`;return(0,s.jsxs)("button",{type:"button",onClick:g,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),className:(0,l.A)("inline-flex items-center font-mono rounded-md transition-all duration-200","bg-bg-subtle/80 hover:bg-bg-elevated border border-border-subtle hover:border-border-strong","cursor-pointer select-none","sm"===d?"text-[10px] px-1.5 py-0.5 gap-1":"text-xs px-2 py-1 gap-1.5",o),title:`Click to copy: ${e}`,"aria-label":`Copy hash ${e}`,children:[(0,s.jsx)("span",{className:(0,l.A)("transition-colors duration-200",m?"text-accent-success":"text-text-secondary"),children:f}),(0,s.jsx)("span",{className:(0,l.A)("flex items-center justify-center transition-all duration-200","sm"===d?"w-3 h-3":"w-3.5 h-3.5"),children:m?(0,s.jsx)(n.A,{className:(0,l.A)("text-accent-success","sm"===d?"w-2.5 h-2.5":"w-3 h-3")}):(0,s.jsx)(i,{className:(0,l.A)("transition-opacity duration-200",x?"opacity-70":"opacity-40","sm"===d?"w-2.5 h-2.5":"w-3 h-3")})})]})}},66088:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(78340).A)("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},66669:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(78340).A)("gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]])},71731:(e,t,a)=>{"use strict";a.d(t,{C:()=>o,W:()=>d});var s=a(95155),r=a(12115),n=a(29722);let i=[{id:"default",src:"/images/bg.jpg",theme:null},{id:"amber",src:"/images/bg-amber.jpg",theme:"amber"},{id:"grey",src:"/images/bg-grey.jpg",theme:"grey"},{id:"black",src:"/images/bg-black.jpg",theme:"black"},{id:"flora",src:"/images/bg-flora.jpg",theme:"flora"}],l="pymc-background",c="pymc-bg-brightness";function o(){let[e,t]=(0,r.useState)("default"),[a,o]=(0,r.useState)(80),[d,m]=(0,r.useState)(!1),[u,x]=(0,r.useState)(!1),p=(0,r.useRef)(null);return((0,r.useEffect)(()=>{x(!0);let e=localStorage.getItem(l),a=localStorage.getItem(c);if(a){let e=parseInt(a,10);!isNaN(e)&&e>=0&&e<=100&&o(e)}if(e&&i.some(t=>t.id===e)){t(e);let a=i.find(t=>t.id===e);a?.theme&&document.documentElement.setAttribute("data-theme",a.theme)}},[]),u)?(0,s.jsx)("div",{className:"flex gap-2 items-center flex-shrink-0",children:i.map(r=>{let u=e===r.id,x=u&&d;return(0,s.jsxs)("div",{ref:u?p:void 0,className:(0,n.A)("relative rounded-md overflow-hidden transition-all duration-300 ease-out","ring-offset-1 ring-offset-bg-body cursor-pointer",u?"ring-2 ring-accent-primary scale-105 w-10 h-10":"ring-1 ring-white/20 hover:ring-white/40 opacity-70 hover:opacity-100 w-10 h-10"),onMouseEnter:()=>u&&m(!0),onMouseLeave:()=>m(!1),onClick:()=>{var e;let a;return!u&&(t(e=r.id),m(!0),localStorage.setItem(l,e),a=i.find(t=>t.id===e),void(a?.theme?document.documentElement.setAttribute("data-theme",a.theme):document.documentElement.removeAttribute("data-theme"),window.dispatchEvent(new CustomEvent("background-change",{detail:e}))))},onMouseDown:e=>{if(!x)return;e.preventDefault();let t=e=>{var t;let a=p.current?.getBoundingClientRect();a&&(o(t=Math.round(Math.max(0,Math.min(100,(1-(e.clientY-a.top)/a.height)*100)))),localStorage.setItem(c,String(t)),window.dispatchEvent(new CustomEvent("brightness-change",{detail:t})))};t(e);let a=e=>t(e),s=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",s)},children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-cover bg-center transition-opacity duration-300",style:{backgroundImage:`url(${r.src})`,opacity:x?.3:1}}),u&&(0,s.jsxs)("div",{className:(0,n.A)("absolute inset-0 flex flex-col items-center justify-center transition-opacity duration-200",x?"opacity-100":"opacity-0 pointer-events-none"),children:[(0,s.jsx)("div",{className:"absolute inset-x-1 inset-y-1 rounded bg-gradient-to-b from-white/40 via-white/10 to-black/90"}),(0,s.jsx)("div",{className:"absolute inset-x-1 bottom-1 rounded-b bg-black/60 transition-all duration-150 ease-out",style:{height:`${100-a}%`}}),(0,s.jsx)("div",{className:"absolute left-1 right-1 h-0.5 bg-accent-primary rounded-full shadow-glow transition-all duration-150 ease-out",style:{top:`${100-a}%`}})]})]},r.id)})}):(0,s.jsx)("div",{className:"flex gap-2"})}function d(){let[e,t]=(0,r.useState)("/images/bg.jpg");return(0,r.useEffect)(()=>{let e=localStorage.getItem(l);t((i.find(t=>t.id===e)||i[0]).src);let a=e=>{t((i.find(t=>t.id===e.detail)||i[0]).src)};return window.addEventListener("background-change",a),()=>{window.removeEventListener("background-change",a)}},[]),e}},78340:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(12115);let r=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,s.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:l="",children:c,iconNode:o,...d},m)=>(0,s.createElement)("svg",{ref:m,...i,width:t,height:t,stroke:e,strokeWidth:r?24*Number(a)/Number(t):a,className:n("lucide",l),...!c&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(d)&&{"aria-hidden":"true"},...d},[...o.map(([e,t])=>(0,s.createElement)(e,t)),...Array.isArray(c)?c:[c]])),c=(e,t)=>{let a=(0,s.forwardRef)(({className:a,...i},c)=>(0,s.createElement)(l,{ref:c,iconNode:t,className:n(`lucide-${r(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,a),...i}));return a.displayName=r(e),a}},83278:(e,t,a)=>{"use strict";let s;a.d(t,{p5:()=>v,xe:()=>y,Sg:()=>b,rf:()=>f,XL:()=>g,jg:()=>p,fL:()=>h,Xb:()=>u,T:()=>x,Ni:()=>j,J3:()=>d,B7:()=>m,Pj:()=>o});var r=a(12115);let n=e=>{let t,a=new Set,s=(e,s)=>{let r="function"==typeof e?e(t):e;if(!Object.is(r,t)){let e=t;t=(null!=s?s:"object"!=typeof r||null===r)?r:Object.assign({},t,r),a.forEach(a=>a(t,e))}},r=()=>t,n={setState:s,getState:r,getInitialState:()=>i,subscribe:e=>(a.add(e),()=>a.delete(e))},i=t=e(s,r,n);return n},i=e=>{let t=e?n(e):n,a=e=>(function(e,t=e=>e){let a=r.useSyncExternalStore(e.subscribe,r.useCallback(()=>t(e.getState()),[e,t]),r.useCallback(()=>t(e.getInitialState()),[e,t]));return r.useDebugValue(a),a})(t,e);return Object.assign(a,t),a};var l=a(27529);let c=(s=(e,t)=>({stats:null,statsLoading:!1,statsError:null,packets:[],packetsLoading:!1,packetsError:null,lastPacketTimestamp:0,logs:[],logsLoading:!1,liveMode:!0,flashReceived:0,flashAdvert:0,fetchStats:async()=>{e({statsLoading:!0,statsError:null});try{let t=await l.GT();e({stats:t,statsLoading:!1})}catch(t){e({statsError:t instanceof Error?t.message:"Failed to fetch stats",statsLoading:!1})}},fetchPackets:async(a=50)=>{e({packetsLoading:!0,packetsError:null});try{let s=await l.V0(a);if(s.success&&s.data){let a=s.data,{lastPacketTimestamp:r}=t(),n=a.length>0?Math.max(...a.map(e=>e.timestamp??0)):0;n>r&&r>0&&e({flashReceived:t().flashReceived+1}),e({packets:a,packetsLoading:!1,lastPacketTimestamp:n||r})}else e({packetsError:s.error||"Failed to fetch packets",packetsLoading:!1})}catch(t){e({packetsError:t instanceof Error?t.message:"Failed to fetch packets",packetsLoading:!1})}},fetchLogs:async()=>{e({logsLoading:!0});try{let t=await l.ao();e({logs:t.logs,logsLoading:!1})}catch(t){e({logsLoading:!1})}},setLiveMode:t=>{e({liveMode:t})},setMode:async e=>{try{(await l.iY(e)).success&&await t().fetchStats()}catch(e){console.error("Failed to set mode:",e)}},setDutyCycle:async e=>{try{(await l.Ty(e)).success&&t().fetchStats()}catch(e){console.error("Failed to set duty cycle:",e)}},sendAdvert:async()=>{try{let a=await l.f3();return a.success&&e({flashAdvert:t().flashAdvert+1}),a.success}catch(e){return console.error("Failed to send advert:",e),!1}},triggerFlashReceived:()=>{e({flashReceived:t().flashReceived+1})},triggerFlashAdvert:()=>{e({flashAdvert:t().flashAdvert+1})}}))?i(s):i,o=c,d=()=>c(e=>e.stats),m=()=>c(e=>e.statsError),u=()=>c(e=>e.packets),x=()=>c(e=>e.packetsLoading),p=()=>c(e=>e.logs),h=()=>c(e=>e.logsLoading),g=()=>c(e=>e.liveMode),f=()=>c(e=>e.flashReceived),b=()=>c(e=>e.flashAdvert),y=()=>c(e=>e.fetchPackets),v=()=>c(e=>e.fetchLogs),j=()=>c(e=>e.setLiveMode)},89363:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(78340).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},94514:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(78340).A)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])}},e=>{_N_E=e(e.s=41593)}]);